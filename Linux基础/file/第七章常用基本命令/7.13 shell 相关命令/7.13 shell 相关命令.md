# 7.13 shell 相关命令

### 7.13.1 bash 命令终端解释器

bash命令来自于英文词组“Bourne shell”的缩写，其功能是命令终端解释器。bash是绝大多数Linux系统默认的命令终端解释器，能够处理用户所输入的命令，以及执行指定的Shell脚本文件。

1. 基本语法

bash [参数] 文件

2. 常用参数

| 参数  |    功能     |
|:---:|:---------:|
| -n  | 检测脚本是否正确本 |
| -x  |  输出执行过程   |
| -c  | 从字符串中读入命令 |

3. 参考实例

使用-n参数检查脚本语法时候正确

```shell
bash -n linuxcool.sh
```

使用-x参数执行linuxcool.sh脚本并输出执行过程

```shell
bash -x linuxcool.sh 
#+ pwd
#/root
#+ uptime
# 16:09:14 up 6 min,  1 user,  load average: 0.24, 0.09, 0.03
```

### 7.13.2 declare 声明shell变量

declare命令用于定义shell变量，但declare定义的变量仅能在当前shell环境中起作用，切换shell环境后将无效。

1. 基本语法

declare [参数] [目录]

2. 常用参数

| 参数  |                功能                |
|:---:|:--------------------------------:|
| -a  |              声明数组变量              |
| -f  |              仅显示函数               |
| -F  |             不显示函数定义              |
| -i  |        先计算表达式，把结果赋给所声明变量         |
| -p  | 显示给定变量的定义的方法和值，当使用此选项时，其他的选项将被忽略 |
| -r  |              定义只读变量              |
| -x  |        将指定的Shell变量转换成环境变量        |

3. 参考实例

显示已定义的变量

```shell
declare 
```

定义新的Shell变量

```shell
declare var1="hello"
```

使用“-i”定义新的变量

```shell
declare -i var2=100+200
```

使用“-p” 显示变量var1和var2的定义

```shell
declare -p var1 var2
```

显示所有的环境变量

```shell
declare -x
```

### 7.13.3 set 设置shell

set命令能设置所使用shell的执行方式，可依照不同的需求来做设置。

1. 基本语法

set [参数]

2. 常用参数

| 参数  |                   功能                    |
|:---:|:---------------------------------------:|
| -a  |           标示已修改的变量，以供输出至环境变量            |
| -b  |            使被中止的后台程序立刻回报执行状态            |
| -C  |           转向所产生的文件无法覆盖已存在的文件            |
| -d  | Shell预设会用杂凑表记忆使用过的指令，以加速指令的执行。使用-d参数可取消 |
| -e  |          若指令传回值不等于0，则立即退出shell          |
| -f  |                 取消使用通配符                 |
| -h  |               自动记录函数的所在位置               |
| -k  |          指令所给的参数都会被视为此指令的环境变量           |
| -l  |              记录for循环的变量名称               |
| -m  |                 使用监视模式                  |

3. 参考实例

使用declare命令定义一个新的环境变量”mylove”，并且将其值设置为”Visual C++”，输入如下命令

```shell
declare mylove='Visual C++' 
```

再使用set命令将新定义的变量输出为环境变量，输入如下命令

```shell
set -a mylove  
```

执行该命令后，将会新添加对应的环境变量。用户可以使用env命令和grep命令分别显示和搜索环境变量”mylove”，输入命令如下

```shell
env | grep mylove 
```

### 7.13.4 source 在当前Shell环境中从指定文件读取和执行命令

source命令（从 C Shell 而来）是bash shell的内置命令。点命令，就是个点符号，（从Bourne Shell而来）是source的另一名称。 source命令通常用于重新执行刚修改的初始化文件，使之立即生效，而不必注销并重新登录。

source返回文件最后一个命令的返回值，如果文件不能读取则会失败。

1. 基本语法

source [文件]

2. 参考实例

读取和执行/root/.bash_profile文件

```shell
source ~/.bash_profile
```

执行刚修改的初始化文件，使之立即生效

```shell
source /etc/bash_profile 
```

在一些工具的执行过程中，会把环境变量设置以”export XXX=XXXXXX”或”declare XXX=XXXXXX”的形式导出到 一个文件中，然后用source加载该文件内容到执行环境中

```shell
vi /etc/profile 
source /etc/profile
```

### 7.13.5 export 系统设置

export命令用于将shell变量输出为环境变量，或者将shell函数输出为环境变量。

一个变量创建时，它不会自动地为在它之后创建的shell进程所知。而命令export可以向后面的shell传递变量的值。当一个shell脚本调用并执 行时，它不会自动得到原为脚本（调用者）里定义的变量的访问权，除非这些变量已经被显式地设置为可用。export命令可以用于传递一个或多个变量的值到任何后继脚本。

1. 基本语法

export [参数]

2. 常用参数

| 参数  |                 功能                  |
|:---:|:-----------------------------------:|
| -f  |           代表[变量名称]中为函数名称            |
| -n  | 删除指定的变量。变量实际上并未删除，只是不会输出到后续指令的执行环境中 |
| -p  |         列出所有的shell赋予程序的环境变量         |

3. 参考实例

列出当前所有的环境变量

```shell
export -p
```

定义环境变量

```shell
export MYENV 
```

定义环境变量赋值

```shell
export MYENV=7
```

### 7.13.6 test 检查条件是否成立

test 命令用于检查某个条件是否成立，它可以进行数值、字符和文件三个方面的测试

test 命令期望在命令行中找到一个参数，当 shell 没有为变量赋值时，则将该变量视为空。这意味着在处理脚本时，一旦脚本寻找的参数不存在，则 test 将报告该错误

1. 基本语法

test  [表达式]

2. 常用参数

|    参数    |   功能    |
|:--------:|:-------:|
| -eq (=)  |  等于则为真  |
| -ne (！=) | 不等于则为真  |
| -gt (>)  |  大于则为真  |
| -ge (>=) | 大于等于则为真 |
| -lt (<)  |  小于则为真  |
| -le (<=) | 小于等于则为真 |

3. 参考实例

判断两个数是否相等

```shell
num1=100 
num2=100 
if test $[num1] -eq $[num2] then     
echo '两个数相等！' 
else     
echo '两个数不相等！' 
fi 
```

比较两个数大小

```shell
num1=101
num2=100 
if test $[num1] -ge $[num2] then     
echo '两个数相等！' 
else     
echo '两个数不相等！' 
fi 
```

判断两个字符串是否相等

```shell
num1="W3Cschool" 
num2="W3Cschool" 
if test num1=num2 then     
echo '两个字符串相等!' 
else     
echo '两个字符串不相等!' 
fi 
```

判断文件是否存在

```shell
cd /bin 
if test -e ./bash then     
echo '文件已存在!' else     
echo '文件不存在!' 
fi 
```

### 7.13.7 read 读取单行数据内容

read命令的功能是用于读取单行数据内容，一般是从标准输入中读取数值，用于给变量赋值

1. 基本语法

read [参数]

2. 常用参数

| 参数  |         功能         |
|:---:|:------------------:|
| -a  | 定义一个数组，以空格为间隔符进行赋值 |
| -d  |      定义一个结束标志      |
| -p  |       设置提示信息       |
| -e  |  在输入的时候可以使用命令补全功能  |
| -n  |     定义输入文本的长度      |
| -r  |      禁用转义符（\）      |
| -s  |     输入字符不在屏幕显示     |
| -t  |      限定最长等待时间      |
| -u  |    从文件描述符中读入信息     |

3. 参考实例

通过用户的输入操作，给指定的变量赋值

```shell
read website 
#www.linuxprobe.com
```

给出一些提示信息，让用户进行输入操作，给指定的变量赋值

```shell
read -p "INPUT: "  website
#INPUT: www.linuxprobe.com
```

限定10秒钟内，让用户进行输入操作，给指定的变量赋值

```shell
read -p "INPUT: " -t 10 website
#INPUT: www.linuxprobe.com
```

限定最大输入字符数量，让用户进行输入操作，给指定的变量赋值

```shell
read -p "INPUT: " -n 7 website
#INPUT: 1234567
```

隐藏字符内容，让用户进行输入操作，给指定的变量赋值

```shell
read -s -p "INPUT: " website
#INPUT: 
```