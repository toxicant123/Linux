# 7.7 搜索查找类

### 7.7.1 find 查找文件或者目录

find 指令将从指定目录向下递归地遍历其各个子目录，将满足条件的文件显示在终端。

1. 基本语法

find [路径] [参数]

2. 常用参数

|        选项         |                                                      功能                                                      |
|:-----------------:|:------------------------------------------------------------------------------------------------------------:|
|    -name<查询方式>    |                                               按照指定的文件名查找模式查找文件                                               |
|    -user<用户名>     |                                                查找属于指定用户名所有文件                                                 |
|    -size<文件大小>    | 按照指定的文件大小查找文件,单位为:<br/>b —— 块（512 字节）<br/>c —— 字节<br/>w —— 字（2 字节） <br/>k —— 千字节 <br/>M —— 兆字节<br/> G —— 吉字节 |
|       -perm       |                                          匹配权限（mode为完全匹配，-mode为包含即可）                                          |
|      -group       |                                                    匹配所有组                                                     |
|   -mtime -n +n    |                                          匹配修改内容的时间（-n指n天以内，+n指n天以前）                                          |
|   -atime -n +n    |                                          匹配访问文件的时间（-n指n天以内，+n指n天以前）                                          |
|   -ctime -n +n    |                                         匹配修改文件权限的时间（-n指n天以内，+n指n天以前）                                         |
|      -nouser      |                                                  匹配无所有者的文件                                                   |
|     -nogroup      |                                                  匹配无所有组的文件                                                   |
|   -newer f1 !f2   |                                               匹配比文件f1新但比f2旧的文件                                               |
| -type b/d/c/p/l/f |                                 匹配文件类型（后面的字幕字母依次表示块设备、目录、字符设备、管道、链接文件、文本文件）                                  |
|      -prune       |                                                    忽略某个目录                                                    |
|   -exec …… {}\;   |                                              后面可跟用于进一步处理搜索结果的命令                                              |

3. 参考实例

按文件名：根据名称查找/目录下的filename.txt文件。

```shell
find xiyou/ -name "*.txt"
```

按拥有者：查找/opt目录下，用户名称为-user的文件

```shell
find xiyou/ -user atguigu
```

按文件大小：在/home目录下查找大于200m的文件（+n 大于 -n小于 n等于）

```shell
find /home -size +204800
```

全盘搜索系统中所有以.conf结尾的文件

```shell
find / -name *.conf
```

搜索当前工作目录中的所有近7天被修改过的文件

```shell
find . -mtime +7
```

### 7.7.2 locate 快速定位文件路径

locate命令其实是find -name的另一种写法，但是要比后者快得多，原因在于它不搜索具体目录，而是搜索一个数据库/var/lib/locatedb，值得注意的是：版本不同，会有所不同。有的版本位置是 /var/lib/mlocate/mlocatedb ，还有的是/var/lib/slocate/slocate.db ，这个数据库中含有本地所有文件信息。

Linux系统自动创建这个数据库，并且每天自动更新一次，所以使用locate命令查不到最新变动过的文件。为了避免这种情况，可以在使用locate之前，先使用updatedb命令，手动更新数据库。

1. 基本语法

locate [参数] [文件]

2. 经验技巧

由于 locate 指令基于数据库进行查询，所以第一次运行前，必须使用 updatedb 指令创建 locate 数据库。

3. 参考实例

查询文件夹

```shell
updatedb
locate tmp
```

### 7.7.3 grep 过滤查找及“|”管道符

grep来自于英文词组“global search regular expression and print out the line”的缩写，意思是用于全面搜索的正则表达式，并将结果输出。人们通常会将grep命令与正则表达式搭配使用，参数作为搜索过程中的补充或对输出结果的筛选，命令模式十分灵活。

与之容易混淆的是egrep命令和fgrep命令。如果把grep命令当作是标准搜索命令，那么egrep则是扩展搜索命令，等价于“grep -E”命令，支持扩展的正则表达式。而fgrep则是快速搜索命令，等价于“grep -F”命令，不支持正则表达式，直接按照字符串内容进行匹配。

管道符，“|”，表示将前一个命令的处理结果输出传递给后面的命令处理

1. 基本语法

grep 参数 查找内容 源文件

2. 常用参数

| 选项  |               功能               |
|:---:|:------------------------------:|
| -i  |             忽略大小写              |
| -c  |           只输出匹配行的数量            |
| -l  |     只列出符合匹配的文件名，不列出具体的匹配行      |
| -n  |         列出所有的匹配行，显示行号          |
| -h  |          查询多文件时不显示文件名          |
| -s  |       不显示不存在、没有匹配文本的错误信息       |
| -v  |         显示不包含匹配文本的所有行          |
| -w  |              匹配整词              |
| -x  |              匹配整行              |
| -r  |              递归搜索              |
| -q  |     禁止输出任何结果，已退出状态表示搜索是否成功     |
| -b  |     打印匹配行距文件头部的偏移量，以字节为单位      |
| -o  | 与-b结合使用，打印匹配的词据文件头部的偏移量，以字节为单位 |
| -F  |           匹配固定字符串的内容           |
| -E  |           支持扩展的正则表达式           |

3. 参考实例

查找某文件在第几行

```shell
ls | grep -n test
```

搜索某个文件中，包含某个关键词的内容

```shell
grep root /etc/passwd
```

搜索某个文件中，以某个关键词开头的内容

```shell
grep ^root /etc/passwd
```