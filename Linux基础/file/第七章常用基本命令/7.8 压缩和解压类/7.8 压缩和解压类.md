# 7.8 压缩和解压类

### 7.8.1 gzip/gunzip 压缩

gzip命令来自于英文单词gunzip的缩写，其功能是用于压缩和解压文件。gzip是一款使用广泛的压缩工具，文件经过压缩后一般会以.gz后缀结尾，与tar命令合用后即为.tar.gz后缀。

据统计，gzip命令对文本文件的压缩比率通常能达到60%~70%，压缩后可以很好的提升存储空间的使用率，还能够在网络传输文件时减少等待时间。

gunzip命令来自于英文词组”Gnu unzip“的缩写，其功能是用于解压提取文件内容。gunzip通常被用来解压那些被基于gzip格式压缩过的文件，也就是那些.gz结尾的压缩包。

1. 基本语法

gzip [参数] 文件 （功能描述：压缩文件，只能将文件压缩为*.gz 文件）

gunzip [参数] 文件.gz （功能描述：解压缩文件命令）

2. gzip 的常用参数

| 选项  |            功能             |
|:---:|:-------------------------:|
| -a  |        使用ASCII文字模式        |
| -d  |          解开压缩文件           |
| -f  |          强行压缩文件           |
| -k  |           保留原文件           |
| -l  |        列出压缩文件的相关信息        |
| -c  | 把压缩后的文件输出到标准输出设备，不去更动原始文件 |
| -r  | 递归处理，将指定目录下的所有文件及子目录一并处理  |
| -q  |          不显示警告信息          |

3. gunzip 的常用参数

|     选项      |                   功能                   |
|:-----------:|:--------------------------------------:|
|     -a      |              使用ASCII文字模式               |
|     -c      |            把解压后的文件输出到标准输出设备            |
|     -f      |  强行解开压缩文件，不理会文件名称或硬连接是否存在以及该文件是否为符号连接  |
|     -h      |                  在线帮助                  |
|     -l      |              列出压缩文件的相关信息               |
|     -L      |               显示版本与版权信息                |
|     -n      |  解压缩时，若压缩文件内含有远来的文件名称及时间戳记，则将其忽略不予处理   |
|     -N      | 解压缩时，若压缩文件内含有原来的文件名称及时间戳记，则将其回存到解开的文件上 |
|     -q      |                不显示警告信息                 |
|     -r      |        递归处理，将指定目录下的所有文件及子目录一并处理        |
| -S<压缩字尾字符串> |               更改压缩字尾字符串                |
|     -t      |              测试压缩文件是否正确无误              |
|     -v      |                显示指令执行过程                |
|     -V      |                 显示版本信息                 |

4. 经验技巧

只能压缩文件不能压缩目录

不保留原来的文件

同时多个文件会产生多个压缩包

5. 参考实例

将指定的文件进行压缩，压缩包默认会以“原文件名.gz”保存到当前工作目录下，原文件会被自动删除

```shell
gzip anaconda-ks.cfg
```

解压指定的压缩包文件，并显示解压过程。解压后的文件会保存在当前工作目录下，压缩包会被自动删除  

```shell
gzip -dv anaconda-ks.cfg.gz 
```

将指定的文件进行压缩，但是不删除原文件

```shell
gzip -k initial-setup-ks.cfg
```

显示指定文件的压缩信息

```shell
gzip -l initial-setup-ks.cfg.gz 
```

解压指定的压缩包文件

```shell
gunzip Filename.gz
```

解压指定的压缩包文件，并输出解压过程

```shell
gunzip -v Filename.gz
```

### 7.8.2 zip/unzip 压缩

zip命令的功能是用于压缩文件，解压命令为unzip。通过zip命令可以将文件打包成.zip格式的压缩包，里面会附含文件的名称、路径、创建时间、上次修改时间等等信息，与tar命令相似

unzip命令用于解压缩zip格式文件，虽然Linux系统中更多的使用tar命令进行对压缩包的管理工作，但有时也会收到同Windows系统常用的.zip和.rar格式的压缩包文件，unzip格式便派上了用场。直接使用unzip命令解压缩文件后，压缩包内原有的文件会被提取并输出保存到当前工作目录下。

1. 基本语法

zip [选项] 文件 

unzip [选项] 压缩包

2. 选项说明

|   zip 选项   |            功能            |
|:----------:|:------------------------:|
|     -q     |        不显示指令执行过程         |
|     -r     | 递归处理，将指定目录下的所有文件和子目录一并处理 |
|     -z     |        替压缩文件加上注释         |
|     -v     |     显示指令执行过程或显示版本信息      |
|     -d     |         更新压缩包内文件         |
| -n <字尾字符串> |     不压缩具有特定字尾字符串的文件      |

| uzip 选项 |            功能            |
|:-------:|:------------------------:|
|   -l    |      显示压缩文件内所包含的文件       |
|   -v    |        执行时显示详细的信息        |
|   -c    | 将解压缩的结果显示到屏幕上，并对字符做适当的转换 |
|   -n    |      解压缩时不要覆盖原有的文件       |
|   -j    |     不处理压缩文件中原有的目录路径      |

3. 经验技巧

zip 压缩命令在windows/linux都通用，可以压缩目录且保留源文件

4. 参考实例

压缩 houge.txt 和bailongma.txt，压缩后的名称为mypackage.zip

```shell
zip mypackage.zip houge.txt bailongma.txt
```

解压 mypackage.zip

```shell
unzip mypackage.zip
```

解压mypackage.zip到指定目录-d

```shell
unzip mypackage.zip -d /opt
```

测试压缩包文件是否完整，文件有无损坏

```shell
unzip -t latest.zip
```

更新压缩包文件中某个文件

```shell
zip -dv backup2.zip anaconda-ks.cfg 
```

### 7.8.3 tar 打包

tar命令的功能是用于压缩和解压缩文件，能够制作出Linux系统中常见的.tar、.tar.gz、.tar.bz2等格式的压缩包文件。对于RHEL7、CentOS7版本以后的系统，解压时可以不加压缩格式参数（如z或j），系统能自动进行分析并解压。

1. 基本语法

tar 参数 文件或目录

2. 常用参数

|         参数         |                功能                 |
|:------------------:|:---------------------------------:|
|         -A         |           新增文件到以存在的备份文件           |
|         -B         |              设置区块大小               |
|         -c         |             建立新的备份文件              |
|      -C <目录>       |       仅压缩指定目录里的内容或解压缩到指定目录        |
|         -d         |              记录文件的差别              |
|         -x         |            从归档文件中提取文件             |
|         -t         |             列出备份文件的内容             |
|         -z         |  通过gzip指令压缩/解压缩文件，文件名最好为*.tar.gz  |
|         -Z         |        通过compress指令处理备份文件         |
|      -f<备份文件>      |              指定备份文件               |
|         -v         |             显示指令执行过程              |
|         -r         |           添加文件到已经压缩的文件            |
|         -u         |       添加改变了和现有的文件到已经存在的压缩文件       |
|         -j         | 通过bzip2指令压缩/解压缩文件，文件名最好为*.tar.bz2 |
|         -v         |              显示操作过程               |
|         -l         |             文件系统边界设置              |
|         -k         |             保留原有文件不覆盖             |
|         -m         |             保留文件不被覆盖              |
|         -w         |            确认压缩文件的正确性             |
|         -p         |           保留原来的文件权限与属性            |
|         -P         |     使用文件名的绝对路径，不移除文件名称前的“/”号      |
|     -N <日期格式>      |       只将较指定日期更新的文件保存到备份文件里        |
| -- -exclude=<范本样式> |            排除符合范本样式的文件            |
|  -- -remove-files  |           归档/压缩之后删除源文件            |


3. 参考实例

压缩多个文件

```shell
tar -zcvf houma.tar.gz houge.txt bailongma.txt
```

压缩目录

```shell
tar -zcvf xiyou.tar.gz xiyou/
```

解压到当前目录

```shell
tar -zxvf houma.tar.gz
```

解压到指定目录

```shell
tar -zxvf xiyou.tar.gz -C /opt
```