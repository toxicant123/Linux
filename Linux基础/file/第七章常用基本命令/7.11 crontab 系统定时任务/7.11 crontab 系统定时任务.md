# 7.11 crontab 系统定时任务

crontab是英文“cron table”的简写。该命令被用来提交和管理用户的需要周期性执行的任务，与windows下的计划任务类似，当安装完成操作系统后，默认会安装此服务工具，并且会自动启动crond进程，crond进程每分钟会定期检查是否有要执行的任务，如果有要执行的任务，则自动执行该任务。

Linux下的任务调度分为两类，系统任务调度和用户任务调度。

系统任务调度：系统周期性所要执行的工作，比如写缓存数据到硬盘、日志清理等。/etc/crontab文件是系统任务调度的配置文件。用户任务调度：用户定期要执行的工作，比如用户数据备份、定时邮件提醒等。用户可以使用 crontab 工具来定制自己的计划任务。所有用户定义的crontab 文件都被保存在 /var/spool/cron目录中。其文件名与用户名一致。

### 7.11.1 crontab 服务管理

1. 重新启动 crond 服务

```shell
systemctl restart crond
```

### 7.11.2 crontab 定时任务设置

1. 基本语法

crontab [参数]

2. 常用参数

| 参数  |      功能       |
|:---:|:-------------:|
| -e  |  编辑该用户的计时器设置  |
| -l  |  列出该用户的计时器设置  |
| -r  | 	删除该用户的计时器设置  |
| -u  | 指定要设定计时器的用户名称 |

3. 参数说明

进入 crontab 编辑界面（`crontab -e`）。会打开 vim 编辑你的工作。

```text
* * * * * 执行的任务
```

结构释义：

|   部分    |     含义     |         范围          |
|:-------:|:----------:|:-------------------:|
| 第一个 "*" | 一小时当中的第几分钟 |        0-59         |
| 第二个 "*" | 一天当中的第几小时  |        0-23         |
| 第三个 "*" | 一个月当中的第几天  |        1-31         |
| 第四个 "*" |  一年当中的第几月  |        1-12         |
| 第五个 "*" |  一周当中的星期几  | 0-7 （ 0 和 7 都代表星期日） |

特殊符号：

| 特殊符号 |                                    含义                                    |
|:----:|:------------------------------------------------------------------------:|
|  *   |                    代表任何时间。比如第一个“*”就代表一小时中每分钟都执行一次的意思                     |
|  ,   | 代表不连续的时间。比如“0 8,12,16 * * * 命令”，就代表在每天的 8 点 0 分，12 点 0 分，16 点 0 分都执行一次命令 |
|  -   |           代表连续的时间范围。比如“0 5 * * 1-6 命令”，代表在周一到周六的凌晨 5 点 0 分执行命令           |
| */n  |             代表每隔多久执行一次。比如“*/10 * * * * 命令”，代表每隔 10 分钟就执行一遍命令             |

特定时间执行命令：

|       时间        |                                    含义                                     |
|:---------------:|:-------------------------------------------------------------------------:|
| 45 22 * * * 命令  |                             每天 22 点 45 分执行命令                              |
|  0 17 * * 1 命令  |                            每周 1 的 17 点 0 分执行命令                            |
| 0 5 1,15 * * 命令 |                        每月 1 号和 15 号的凌晨 5 点 0 分执行命令                        |
| 40 4 * * 1-5 命令 |                          每周一到周五的凌晨 4 点 40 分执行命令                           |
| */10 4 * * * 命令 |                         每天的凌晨 4 点，每隔 10 分钟执行一次命令                          |
| 0 0 1,15 * 1 命令 | 每月 1 号和 15 号，每周 1 的 0 点 0 分都会执行命令。注意：星期几和几号最好不要同时出现，因为他们定义的都是天。非常容易让管理员混乱 |

4. 参考实例

每隔 1 分钟，向/root/bailongma.txt 文件中添加一个 11 的数字

```text
*/1 * * * * /bin/echo ”11” >> /root/bailongma.txt
```