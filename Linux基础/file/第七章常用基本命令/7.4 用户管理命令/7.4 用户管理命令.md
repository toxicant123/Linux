# 7.4 用户管理命令

useradd命令来自于英文词组“User add”的全拼，其功能是用于创建并设置用户信息。使用useradd命令可以自动的完成创建用户的信息、基本组、家目录等工作，并在创建的过程中对用户初始信息进行定制

### 7.4.1 useradd 添加新用户

1. 基本语法

useradd [参数] 用户名

2. 常用参数

| 选项  |                      功能                      |
|:---:|:--------------------------------------------:|
| -D  |                  改变新建用户的预设值                  |
| -c  |                    添加备注文字                    |
| -d  |               新用户每次登陆时所使用的家目录                |
| -e  |           用户终止日期，日期的格式为YYYY-MM-DD            |
| -f  | 用户过期几日后永久停权。当值为0时用户立即被停权，而值为-1时则关闭此功能，预设值为-1 |
| -g  |                  指定用户对应的用户组                  |
| -G  |                定义此用户为多个不同组的成员                |
| -m  |                用户目录不存在时则自动创建                 |
| -M  |       不建立用户家目录，优先于/etc/login.defs文件设定        |
| -n  |                取消建立以用户名称为名的群组                |
| -r  |                    建立系统帐号                    |
| -u  |                    指定用户id                    |

3. 参考实例

添加一个用户

```shell
useradd tangseng
```

创建指定的用户信息，并追加指定组为该账户的扩展组

```shell
useradd -G root user4
```

创建指定的用户信息，并指定过期时间

```shell
useradd -e "2023/01/01" user5
```

创建指定的用户信息，并自定义UID值

```shell
useradd -u 6688 user3
```

### 7.4.2 passwd 设置用户密码

1. 基本语法

passwd [参数] 用户名

2. 常用参数

| 选项  |         功能         |
|:---:|:------------------:|
| -d  |        删除密码        |
| -l  |  锁定用户密码，无法被用户自行修改  |
| -u  | 解开已锁定用户密码，允许用户自行修改 |
| -e  | 密码立即过期，下次登陆强制修改密码  |
| -k  | 保留即将过期的用户在期满后能仍能使用 |
| -S  |       查询密码状态       |


3. 参考实例

修改当前登陆的账户密码

```shell
passwd
```

设置用户的密码

```shell
passwd tangseng
```

锁定密码不允许用户修改

```shell
passwd -l linuxcool
```

下次登陆强制改密码

```shell
passwd -e linuxcool
```

### 7.4.3 id 查看用户

id命令可以显示真实有效的用户ID(UID)和组ID(GID)。UID 是对一个用户的单一身份标识。组ID（GID）则对应多个UID。id命令已经默认预装在大多数Linux系统中。要使用它，只需要在你的控制台输入id。不带选项输入id会显示如下。结果会使用活跃用户。

当我们想知道某个用户的UID和GID时id命令是非常有用的。一些程序可能需要UID/GID来运行。id使我们更加容易地找出用户的UID以GID而不必在/etc/group文件中搜寻。如往常一样，你可以在控制台输入man id进入id的手册页来获取更多的详情。

1. 基本语法

id [参数] [用户名]

2. 常用参数

|    选项     |        功能         |
|:---------:|:-----------------:|
|    -g     |    显示用户所属群组的ID    |
|    -G     |   显示用户所属附加群组的ID   |
|    -n     | 显示用户，所属群组或附加群组的名称 |
|    -r     |      显示实际ID       |
|    -u     |      显示用户ID       |
|  --help   |       显示帮助        |
| --version |      显示版本信息       |

3. 参考实例

查看用户

```shell
id tangseng
```

### 7.4.4 cat /etc/passwd 查看创建了哪些用户

1. 参考实例

```shell
cat /etc/passwd
```

### 7.4.5 su 切换用户

su: swith user 切换用户

1. 基本语法

su 用户名称 （功能描述：切换用户，只能获得用户的执行权限，不能获得环境变量）

su - 用户名称 （功能描述：切换到用户并获得该用户的环境变量及执行权限）

2. 参考实例

切换用户

```shell
sudu tangseng
```

### 7.4.6 userdel 删除用户

1. 基本语法

* userdel 用户名 （功能描述：删除用户但保存用户主目录）

* userdel -r 用户名 （功能描述：用户和用户主目录，都删除）

2. 选项说明

| 选项  |          功能           |
|:---:|:---------------------:|
| -r  | 删除用户的同时，删除与用户相关的所有文件。 |

3. 参考实例

* 删除用户（保存用户主目录）

```shell
userdel tangseng
```

* 删除用户和用户主目录，都删除

```shell
userdel -r zhubajie
```

### 7.4.7 who 查看登录用户信息

1. 基本语法

* whoami （功能描述：显示自身用户名称）

* who am i （功能描述：显示登录用户的用户名以及登陆时间）

2. 参考实例

* 显示自身用户名称

```shell
whoami
```

* 显示登录用户的用户名

```shell
who am i
```

### 7.4.8 sudo 设置普通用户具有 root 权限

1. 添加 atguigu 用户，并对其设置密码

```shell
useradd atguigu
passwd atguigu
```

2. 修改配置文件

```shell
vim /etc/sudoers
```

修改 /etc/sudoers 文件，找到下面一行(91 行)，在 root 下面添加一行，如下所示：

```text
## Allow root to run any commands anywhere
root    ALL=(ALL) ALL
atguigu ALL=(ALL) ALL
```

或者配置成采用 sudo 命令时，不需要输入密码

```text
## Allow root to run any commands anywhere
root    ALL=(ALL) ALL
atguigu ALL=(ALL) NOPASSWD:ALL
```

修改完毕，现在可以用 atguigu 帐号登录，然后用命令 sudo ，即可获得 root 权限进行操作。

### 7.4.9 usermod 修改用户

1. 基本语法

usermod -g 用户组 用户名

2. 选项说明

| 选项  |               功能                |
|:---:|:-------------------------------:|
| -g  | 修改用户的初始登录组，给定的组必须存在。默认组 id 是 1。 |

3. 参考实例

将用户加入到用户组

```shell
usermod -g root zhubajie
```