# 第二章 单机部署

## 2.1 Windows系统中的安装启动

### 2.1.1 第一步：下载安装包

MongoDB 提供了可用于 32 位和 64 位系统的预编译二进制包，你可以从MongoDB官网下载安装，MongoDB 预编译二进制包下载地址：https://www.mongodb.com/try/download/community

![img.png](img.png)

提示：版本的选择：\
MongoDB的版本命名规范如：x.y.z；\
y为奇数时表示当前版本为开发版，如：1.5.2、4.1.13；\
y为偶数时表示当前版本为稳定版，如：1.6.3、4.0.10；\
z是修正版本号，数字越大越好。

详情：http://docs.mongodb.org/manual/release-notes/#release-version-numbers

### 2.1.2 第二步：解压安装启动

如果下载的是`.msi`文件直接打开安装即可

如果下载的是`.zip`文件：

将压缩包解压到一个目录中。\
在解压目录中，手动建立一个目录用于存放数据文件，如 `data/db`

方式1：命令行参数方式启动服务

在 bin 目录中打开命令行提示符，输入如下命令：

```shell
mongod --dbpath=..\data\db
```

我们在启动信息中可以看到，mongoDB的默认端口是27017，如果我们想改变默认的启动端口，可以通过--port来指定端口。

为了方便我们每次启动，可以将安装目录的bin目录设置到环境变量的path中， bin 目录下是一些常用命令，比如 mongod 启动服务用的，mongo 客户端连接服务用的。

方式2：配置文件方式启动服务

在解压目录中新建 config 文件夹，该文件夹中新建配置文件 mongod.conf ，内如参考如下：

```yaml
storage:
  #The directory where the mongod instance stores its data.Default Value is "\data\db" on Windows.
  dbPath: D:\02_Server\DBServer\mongodb-win32-x86_64-2008plus-ssl-4.0.1\data
```

详细配置项内容可以参考官方文档：https://docs.mongodb.com/manual/reference/configuration-options/

【注意】

1) 配置文件中不能以Tab分割字段

解决：\
将其转换成空格。

启动方式：

```shell
mongod -f ../config/mongod.conf
#或
mongod --config ../config/mongod.conf
```

更多参数配置：

```yaml
systemLog:
  destination: file
  #The path of the log file to which mongod or mongos should send all diagnostic logging information
  path: "D:/02_Server/DBServer/mongodb-win32-x86_64-2008plus-ssl-4.0.1/log/mongod.log"
  logAppend: true
storage:
  journal:
    enabled: true
  #The directory where the mongod instance stores its data.Default Value is "/data/db".
  dbPath: "D:/02_Server/DBServer/mongodb-win32-x86_64-2008plus-ssl-4.0.1/data"
net:
  #bindIp: 127.0.0.1
  port: 27017
setParameter:
  enableLocalhostAuthBypass: false
```

## 2.2 Shell连接(mongo命令)

进入服务器安装目录的bin目录中

![img_1.png](img_1.png)

在地址栏中输入`cmd`，打开命令提示图，然后输入以下shell命令即可完成登陆

```shell
mongo
#或
mongo --host=127.0.0.1 --port=27017
```

查看已经有的数据库

```shell
show databases
```

退出mongodb

```shell
exit
```

更多参数可以通过帮助查看：

```shell
mongo --help
```

提示：\
MongoDB javascript shell是一个基于javascript的解释器，故是支持js程序的。

## 2.3 Compass-图形化界面客户端

进入MongoDB官网下载MongoDB Compass，地址：https://www.mongodb.com/try/download/compass

如果是下载安装版，则按照步骤安装；如果是下载加压缩版，直接解压，执行里面的`MongoDBCompassCommunity.exe`文件即可。

在打开的界面中，输入主机地址、端口等相关信息，点击连接：

![img_2.png](img_2.png)

## 2.4 Linux系统中的安装启动和连接

目标：在Linux中部署一个单机的MongoDB，作为生产环境下使用。

提示：和Windows下操作差不多。

步骤如下：
1. 先进入官网 https://www.mongodb.com/try/download/community ，按下图显示，下载压缩包`mongod-linux-x86_64-4.0.28.tgz`。 
![img_3.png](img_3.png)
2. 上传压缩包到Linux中的`/opt/mongodb`目录下，解压到当前目录：

```shell
tar -xvf mongodb-linux-x86_64-4.0.10.tgz
```